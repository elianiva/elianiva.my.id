---
import { getCollection } from "astro:content";
import MotionReveal from "~/components/animation/MotionReveal.svelte";
import BlogSection from "~/components/section/BlogSection.astro";
import OpenSourceSection from "~/components/section/OpenSourceSection.astro";
import ProjectSection from "~/components/section/ProjectSection.astro";
import WorkExperienceSection from "~/components/section/WorkExperienceSection.astro";
import siteData from "~/data/sites";
import { workExperiences } from "~/data/work-experience";
import MainLayout from "~/layouts/MainLayout.astro";
import EnvelopeIcon from "~icons/ph/envelope-duotone";
import GithubLogoIcon from "~icons/ph/github-logo-duotone";
import LinkedinLogoIcon from "~icons/ph/linkedin-logo-duotone";
import CvLogoIcon from "~icons/ph/read-cv-logo-duotone";
import XLogoIcon from "~icons/ph/x-logo-duotone";

type Social = {
	// biome-ignore lint/suspicious/noExplicitAny: i don't care about icon types
	icon: any;
	link: string;
	label: string;
};

const socials: Social[] = [
	{
		icon: EnvelopeIcon,
		link: `mailto:${siteData.email}`,
		label: "Email",
	},
	{
		icon: GithubLogoIcon,
		link: siteData.github,
		label: "Github",
	},
	{
		icon: LinkedinLogoIcon,
		link: siteData.linkedin,
		label: "LinkedIn",
	},
	{
		icon: XLogoIcon,
		link: siteData.twitter,
		label: "Twitter",
	},
	{
		icon: CvLogoIcon,
		link: siteData.cv,
		label: "Résumé",
	},
];

const personalProjects = await getCollection(
	"projects",
	({ data }) => data.type === "personal" && data.featured,
);
const sortedPersonalProjects = personalProjects.sort((a, b) =>
	a.data.date > b.data.date ? -1 : 1,
);

const posts = await getCollection("posts", ({ data }) => !data.draft);
const sortedPosts = posts.sort((a, b) => (a.data.date > b.data.date ? -1 : 1));
---

<MainLayout seo={{ title: "Home" }}>
	<main class="mx-auto max-w-[920px] px-2 md:px-4 py-10">
		<header role="banner">
			<MotionReveal
				as="div"
				client:idle
				class="flex flex-col-reverse md:flex-row gap-6 border-b border-pink-200/50 pb-8"
			>
				<div class="flex-1">
					<h1
						class="text-2xl md:text-3xl font-bold font-display text-pink-950 tracking-wide"
					>
						Dicha Z<span
							class="text-pink-600"
							title="Yes, this is where the username comes from"
							>elianiva</span
						>n Arkana
					</h1>
					<p
						class="text-sm md:text-base leading-relaxed font-body text-pink-950/80 py-3 max-w-[60ch]"
					>
						Software Engineer, Open Source Enthusiast, and a lifetime
						learner. I love to build things that solves problems and
						make people's life easier. Great to see you here! :)
					</p>
					<MotionReveal
						as="div"
						client:idle
						group
						groupSelector="a"
						stagger={0.08}
						class="flex items-center flex-wrap gap-2 pt-2 justify-center md:justify-start"
					>
						{
							socials.map((social) => (
								<a
									class="group focus:outline-none focus:ring-0"
									href={social.link}
									target="_blank"
									rel="noopener noreferrer"
									title={social.label}
									aria-label={`Visit ${social.label} profile`}
								>
									<div
										class="rounded-lg group-hover:rounded-2xl transition-all py-2 px-4 text-pink-950 group-hover:text-pink-950 bg-white/50 hover:bg-pink-50 border border-pink-200/50 flex items-center gap-2 group-focus:outline-none group-focus:ring-2 group-focus:ring-pink-400 group-focus:ring-offset-2"
									>
										<social.icon class="w-4 h-4" />
										<span class="text-xs font-mono uppercase">{social.label}</span>
									</div>
								</a>
							))
						}
					</MotionReveal>
				</div>
				<!-- Profile image with blob shape and floating animation -->
				<MotionReveal
					as="div"
					client:idle
					variant="float"
					delay={0.1}
					class="relative mb-4 md:mb-0 mx-auto"
				>
					<a
						href={siteData.github}
						target="_blank"
						rel="noopener noreferrer"
						class="relative block w-40 h-40 group"
						aria-label="Visit GitHub profile"
					>
						<!-- Layered shadows -->
						<div class="absolute inset-0 blob-shape bg-pink-200/50 translate-x-2 translate-y-2 transition-transform duration-300 group-hover:translate-x-3 group-hover:translate-y-3"></div>
						<div class="absolute inset-0 blob-shape bg-pink-300/30 translate-x-1 translate-y-1 transition-transform duration-300 group-hover:translate-x-2 group-hover:translate-y-2"></div>
						<!-- Image container with blob shape -->
						<div class="relative w-full h-full blob-shape overflow-hidden border-2 border-pink-300 transition-transform duration-300 group-hover:-translate-y-1"
						>
							<img
								src="https://avatars.githubusercontent.com/u/51877647?v=4"
								alt="Profile photo of Dicha Zelianiva Arkana"
								class="w-full h-full object-cover"
								loading="eager"
							/>
						</div>
					</a>
				</MotionReveal>
			</MotionReveal>
		</header>
		<section role="region" aria-labelledby="about-heading">
			<MotionReveal
				as="div"
				delay={0.05}
				client:idle
				class="pt-4 md:pt-8"
			>
				<h2 id="about-heading" class="text-xl md:text-2xl font-bold font-display text-pink-950 pb-4 tracking-wide">
					About Me
				</h2>
			<p
				class="text-sm md:text-base leading-relaxed font-body text-pink-950/80"
				>
					Design engineer wannabe with 4+ years of experience on web-related things.
					I like building softwares in general and enjoy geeking out about them.
					Loves to learn and tinker with random things, currently in the process
					of learning Japanese and becoming a coffee snob (not actually, I just like coffee :)
					Feel free to say hi!
				</p>
			</MotionReveal>
		</section>
		<section role="region" aria-labelledby="experience-heading">
			<MotionReveal
				as="div"
				group
				groupSelector=".work-experience-card"
				amount={0}
				stagger={0.08}
				delay={0.05}
				client:idle
			>
				<WorkExperienceSection workExperiences={workExperiences} />
			</MotionReveal>
		</section>
		<section role="region" aria-labelledby="open-source-contributions-heading">
			<MotionReveal
				as="div"
				group
				groupSelector=".work-experience-card"
				amount={0}
				stagger={0.08}
				delay={0.05}
				client:idle
			>
				<OpenSourceSection />
			</MotionReveal>
		</section>
		<section role="region" aria-labelledby="blog-heading">
			<BlogSection posts={sortedPosts} />
		</section>
		<section role="region" aria-labelledby="personal-projects-heading">
			<ProjectSection
				title="Personal Projects"
				description="These are some of my personal projects that I made in the past. Some of them are still in use, some are not. Mostly made them just for fun and to learn new things!"
				projects={sortedPersonalProjects}
				seeMoreUrl="/projects"
			/>
		</section>
	</main>
</MainLayout>
