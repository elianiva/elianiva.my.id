---
import { getCollection } from "astro:content";
import MotionReveal from "~/components/animation/MotionReveal.svelte";
import BlogSection from "~/components/section/BlogSection.astro";
import OpenSourceSection from "~/components/section/OpenSourceSection.astro";
import ProjectSection from "~/components/section/ProjectSection.astro";
import WorkExperienceSection from "~/components/section/WorkExperienceSection.astro";
import siteData from "~/data/sites";
import { workExperiences } from "~/data/work-experience";
import MainLayout from "~/layouts/MainLayout.astro";
import EnvelopeIcon from "~icons/ph/envelope-duotone";
import GithubLogoIcon from "~icons/ph/github-logo-duotone";
import LinkedinLogoIcon from "~icons/ph/linkedin-logo-duotone";
import CvLogoIcon from "~icons/ph/read-cv-logo-duotone";
import XLogoIcon from "~icons/ph/x-logo-duotone";

type Social = {
	icon: any;
	link: string;
	label: string;
};

const socials: Social[] = [
	{
		icon: EnvelopeIcon,
		link: `mailto:${siteData.email}`,
		label: "Email",
	},
	{
		icon: GithubLogoIcon,
		link: siteData.github,
		label: "Github",
	},
	{
		icon: LinkedinLogoIcon,
		link: siteData.linkedin,
		label: "LinkedIn",
	},
	{
		icon: XLogoIcon,
		link: siteData.twitter,
		label: "Twitter",
	},
	{
		icon: CvLogoIcon,
		link: siteData.cv,
		label: "Résumé",
	},
];

const personalProjects = await getCollection(
	"projects",
	({ data }) => data.type === "personal" && data.featured,
);
const sortedPersonalProjects = personalProjects.sort((a, b) =>
	a.data.date > b.data.date ? -1 : 1,
);

const posts = await getCollection("posts", ({ data }) => !data.draft);
const sortedPosts = posts.sort((a, b) => (a.data.date > b.data.date ? -1 : 1));
---

<MainLayout seo={{ title: "Home" }}>
	<main class="mx-auto max-w-[920px] px-2 md:px-4 py-10">
		<header role="banner">
			<MotionReveal
				as="div"
				client:idle
				class="flex flex-col-reverse md:flex-row gap-4 border-b border-pink-800 border-dashed border-spacing-lg pb-6"
			>
			<div class="flex-1">
				<h1
					class="text-xl md:text-2xl font-bold font-serif text-pink-950"
				>
					Dicha Z<span
						class="text-pink-700"
						title="Yes, this is where the username comes from"
						>elianiva</span
					>n Arkana
				</h1>
				<p
					class="text-sm md:text-base leading-relaxed font-serif text-pink-950/80 py-2 max-w-[60ch]"
				>
					Software Engineer, Open Source Enthusiast, and a lifetime
					learner. I love to build things that solves problems and
					make people's life easier. Great to see you here! :)
				</p>
				<MotionReveal
					as="div"
					client:idle
					group
					groupSelector="a"
					stagger={0.05}
					class="flex items-center flex-wrap gap-2 pt-2 justify-center md:justify-start"
				>
					{
						socials.map((social) => (
							<a
								href={social.link}
								class="text-pink-950/80 hover:text-pink-950 p-1 rounded-md border border-pink-300 flex items-center gap-1 focus:outline-none focus:ring-2 focus:ring-pink-400 focus:ring-offset-2"
								target="_blank"
								rel="noopener noreferrer"
								title={social.label}
								aria-label={`Visit ${social.label} profile`}
							>
								<social.icon />
								<span class="text-xs font-mono uppercase">{social.label}</span>
							</a>
						))
					}
				</MotionReveal>
			</div>
			<a
				href={siteData.github}
				target="_blank"
				rel="noopener noreferrer"
				class="relative mb-4 md:mb-0 mx-auto size-36 border-2 border-pink-300 border-dashed rounded-full focus:outline-none focus:ring-4 focus:ring-pink-400 focus:ring-offset-4"
				aria-label="Visit GitHub profile"
			>
				<img
					src="https://avatars.githubusercontent.com/u/51877647?v=4"
					alt="Profile photo of Dicha Zelianiva Arkana"
					class="w-full h-full object-cover rounded-full"
				/>
			</a>
			</MotionReveal>
		</header>
		<section role="region" aria-labelledby="about-heading">
			<MotionReveal
				as="div"
				delay={0.05}
				client:idle
				class="pt-6 md:pt-10"
			>
				<h2 id="about-heading" class="text-xl md:text-2xl font-bold font-serif text-pink-950 pb-4">
					About Me
				</h2>
			<p
				class="text-sm md:text-base leading-relaxed font-serif text-pink-950/80"
			>
				Design engineer wannabe with 4+ years of experience on web-related things.
				I like building softwares in general and enjoy geeking out about them.
				Loves to learn and tinker with random things, currently in the process
				of learning Japanese and becoming a coffee snob (not actually, I just like coffee :)
				Feel free to say hi!
			</p>
			</MotionReveal>
		</section>
		<section role="region" aria-labelledby="experience-heading">
			<MotionReveal
				as="div"
				group
				groupSelector=".work-experience-card"
				amount={0}
				stagger={0.05}
				delay={0.05}
				client:idle
			>
				<WorkExperienceSection workExperiences={workExperiences} />
			</MotionReveal>
		</section>
		<section role="region" aria-labelledby="open-source-contributions-heading">
			<OpenSourceSection />
		</section>
		<section role="region" aria-labelledby="blog-heading">
			<BlogSection posts={sortedPosts} />
		</section>
		<section role="region" aria-labelledby="personal-projects-heading">
			<ProjectSection
				title="Personal Projects"
				description="These are some of my personal projects that I made in the past. Some of them are still in use, some are not. Mostly made them just for fun and to learn new things!"
				projects={sortedPersonalProjects}
				seeMoreUrl="/projects"
			/>
		</section>
	</main>
</MainLayout>
