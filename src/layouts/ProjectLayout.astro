---
import siteData from "~/data/sites";
import type { ProjectMeta } from "~/models/project";
import GithubIcon from "~icons/ph/github-logo-duotone";
import GlobeIcon from "~icons/ph/globe-hemisphere-west-duotone";
import BackButton from "../components/BackButton.astro";
import MainLayout from "./MainLayout.astro";

export type Props = {
	frontmatter: ProjectMeta;
	slug: string;
};
const { frontmatter, slug } = Astro.props as Props;
---

<MainLayout
	seo={{
		title: frontmatter.title,
		description: frontmatter.description,
		thumbnail: `${siteData.siteUrl}/${slug}/cover.webp`,
	}}
>
	<main class="mx-auto max-w-[920px] px-2 md:px-4 py-10" style={`view-transition-name: project-card-${slug}`}>
		<div>
			<BackButton />
		</div>

		<div class="pt-6">
			<section class="grid grid-cols-1 md:grid-cols-[2fr_1fr] gap-4" style={`view-transition-name: project-content-${slug}`}>
				<div class="space-y-6">
					{frontmatter.hasImage && (
						<div class="rounded-2xl overflow-hidden border-[0.5px] border-pink-200/50">
							<img
								src={`/assets/projects/${slug}/cover.webp`}
								alt={frontmatter.title}
								class="block w-full h-full bg-pink-100"
								loading="lazy"
							/>
						</div>
					)}

					<div>
						<div class="flex flex-col md:flex-row gap-4 items-start md:items-center justify-between pb-4 border-b border-pink-200/50">
						<h1
							class="text-2xl md:text-3xl font-bold font-display text-pink-950 tracking-wide"
						>
							{frontmatter.title}
						</h1>
							<div class="flex gap-2">
								<a
									class="flex gap-2 items-center bg-white/50 hover:bg-pink-50 border-[0.5px] border-pink-200/50 hover:border-pink-200 py-2 px-4 text-pink-950 hover:text-pink-800 rounded-lg transition-all focus:outline-none focus:ring-2 focus:ring-pink-400 focus:ring-offset-2"
									href={frontmatter.source} target="_blank" rel="noopener noreferrer"
								>
									<GithubIcon class="w-5 h-5" />
									<span class="text-sm font-mono uppercase">Source</span>
								</a>
								{
									frontmatter.demo !== null && (
										<a
											class="flex gap-2 items-center bg-pink-50/80 hover:bg-pink-50 border-[0.5px] border-pink-200/50 hover:border-pink-200 py-2 px-4 text-pink-950 hover:text-pink-800 rounded-lg transition-all focus:outline-none focus:ring-2 focus:ring-pink-400 focus:ring-offset-2"
											href={frontmatter.demo} target="_blank" rel="noopener noreferrer"
										>
											<GlobeIcon class="w-5 h-5" />
											<span class="text-sm font-mono uppercase">Visit</span>
										</a>
									)
								}
							</div>
						</div>
						<main class="prose pt-4">
							<slot />
						</main>
					</div>
				</div>

				<aside class="h-fit">
					<div>
						<h2 class="text-xl font-bold font-display text-pink-950 tracking-wide pb-3 border-b border-pink-200/50">
							Tech Stack
						</h2>
						<div class="space-y-3 pt-4">
							{
								frontmatter.stack.map(([stackName, stackHomepage]) => (
									<div class="flex items-center gap-3 group">
										<div class="flex items-center justify-center p-2 bg-pink-50/80 rounded-lg border-[0.5px] border-pink-200/50 w-12 h-12 shrink-0">
											<img
												class={`w-full h-full object-contain ${stackName.toLowerCase() === "nextjs" ? "filter invert" : ""}`}
												src={`/assets/logo/${stackName.toLowerCase().replace(/\s+/g, "-")}.png`}
												alt={stackName}
											/>
										</div>
										<a
											href={stackHomepage}
											class="text-sm font-body text-pink-950 hover:text-pink-700 transition-colors focus:outline-none focus:ring-2 focus:ring-pink-400 focus:ring-offset-1 rounded"
											target="_blank"
											rel="noopener noreferrer"
										>
											{stackName}
										</a>
									</div>
								))
							}
						</div>
					</div>
				</aside>
			</section>
		</div>
	</main>
</MainLayout>
